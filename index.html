<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Wallet Connect Stable</title>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
<script src="https://unpkg.com/@walletconnect/ethereum-provider@2.11.0/dist/index.umd.js"></script>

<style>
body{
  background:#000;
  color:#fff;
  font-family:Arial;
  text-align:center;
  padding-top:100px;
}
button{
  padding:15px 30px;
  background:gold;
  border:none;
  border-radius:10px;
  font-weight:bold;
  cursor:pointer;
}
</style>
</head>

<body>

<h2>Universal Wallet Connect</h2>
<button onclick="connectWallet()">Connect Wallet</button>
<div id="walletDisplay" style="margin-top:20px;color:gold;"></div>

<script>

let provider, signer, userAddress;

const projectId = "d1b044ae2663b9697bc5ab584bfb57e5";

async function connectWallet() {

  try {

    // üî• 1Ô∏è‚É£ If injected wallet exists
    if (window.ethereum) {

      await window.ethereum.request({ method: "eth_requestAccounts" });

      provider = new ethers.providers.Web3Provider(window.ethereum);
      signer = provider.getSigner();
      userAddress = await signer.getAddress();

    } else {

      // üî• 2Ô∏è‚É£ WalletConnect fallback
      const wcProvider = await window.EthereumProvider.init({
        projectId: projectId,
        chains: [56],
        showQrModal: true
      });

      await wcProvider.enable();

      provider = new ethers.providers.Web3Provider(wcProvider);
      signer = provider.getSigner();
      userAddress = await signer.getAddress();
    }

    const network = await provider.getNetwork();

    if (network.chainId !== 56) {
      alert("Switch to BNB Smart Chain");
      return;
    }

    document.getElementById("walletDisplay").innerHTML =
      "Connected: " + userAddress;

  } catch (err) {
    console.log(err);
    alert("Connection Failed: " + err.message);
  }
}

</script>

</body>
</html>
